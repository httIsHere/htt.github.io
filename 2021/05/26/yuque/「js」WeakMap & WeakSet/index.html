<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="referrer" content="no-referrer" />

    <meta name="author" content="httishere">





<title>ã€Œjsã€WeakMap &amp;amp; WeakSet | HTTISHERE</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.2.0"></head>
<body>
    <div class="wrapper">
        <header>
  <nav class="navbar">
    <div class="container">
      <div class="navbar-header header-logo">
        <a href="/">HTTISHERE&#39;s Blog</a>
      </div>
      <div class="menu navbar-right">
        
        <a class="menu-item" href="/archives">Posts</a>
        
        <a class="menu-item" href="/category">Categories</a>
        
        <a class="menu-item" href="/tag">Tags</a>
        
        <a class="menu-item" href="/about">About</a>
        
        <input id="switch_default" type="checkbox" class="switch_default" />
        <label for="switch_default" class="toggleBtn"></label>
        <a
          href="javascript:;"
          rel="sidebar"
          style="margin-left: 20px;"
          onclick="addFav();"
          >ğŸŒŸ Bookmark</a
        >
      </div>
    </div>
  </nav>

  
  <nav class="navbar-mobile" id="nav-mobile">
    <div class="container">
      <div class="navbar-header">
        <div>
          <a href="/">HTTISHERE&#39;s Blog</a
          ><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
        </div>
        <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
      </div>
      <div class="menu" id="mobile-menu">
        
        <a class="menu-item" href="/archives">Posts</a>
        
        <a class="menu-item" href="/category">Categories</a>
        
        <a class="menu-item" href="/tag">Tags</a>
        
        <a class="menu-item" href="/about">About</a>
        
      </div>
    </div>
  </nav>
</header>
<script>
  var mobileBtn = function f() {
    var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
    var mobileMenu = document.getElementById("mobile-menu");
    if (toggleMenu.classList.contains("active")) {
      toggleMenu.classList.remove("active");
      mobileMenu.classList.remove("active");
    } else {
      toggleMenu.classList.add("active");
      mobileMenu.classList.add("active");
    }
  };
  function addFav() {
    var title = document.title;
    var URL = document.URL;
    try {
      window.external.addFavorite(URL, title);
    } catch (e) {
      try {
        window.sidebar.addPanel(title, URL, "");
      } catch (e) {
        alert("ç”±äºæµè§ˆå™¨çš„å®‰å…¨è®¾ç½®\nå¯ä»¥ä½¿ç”¨Ctrl+Dæˆ–è€…Command+Dè¿›è¡Œæ‰‹åŠ¨æ”¶è—");
      }
    }
  }
</script>

        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">ã€Œjsã€WeakMap &amp;amp; WeakSet</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">httishere</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">05/26/2021&nbsp;&nbsp;15:22:53</a>
                        </span>
                    
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h2><blockquote>
<p>å¯¹è±¡æ˜¯<strong>ä¸€ç»„é”®/å€¼å¯¹</strong>çš„é›†åˆï¼Œå…¶ä¸­çš„<strong>é”®æ˜¯å¼±å¼•ç”¨</strong>çš„ã€‚å…¶é”®å¿…é¡»æ˜¯å¯¹è±¡ï¼Œè€Œå€¼å¯ä»¥æ˜¯ä»»æ„çš„ã€‚</p>
</blockquote>
<p>key æ˜¯å¼±å¼•ç”¨ï¼š<code>WeakMaps hold &quot;weak&quot; references to key objects</code>ã€‚</p>
<blockquote>
<p>åœ¨è®¡ç®—æœºç¨‹åºè®¾è®¡ä¸­ï¼Œå¼±å¼•ç”¨ä¸å¼ºå¼•ç”¨ç›¸å¯¹ï¼Œæ˜¯æŒ‡ä¸èƒ½ç¡®ä¿å…¶å¼•ç”¨çš„å¯¹è±¡ä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„å¼•ç”¨ã€‚ ä¸€ä¸ªå¯¹è±¡è‹¥åªè¢«å¼±å¼•ç”¨æ‰€å¼•ç”¨ï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯ä¸å¯è®¿é—®ï¼ˆæˆ–å¼±å¯è®¿é—®ï¼‰çš„ï¼Œå¹¶å› æ­¤å¯èƒ½åœ¨ä»»ä½•æ—¶åˆ»è¢«å›æ”¶ã€‚<br>å¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†<strong>åªå…·æœ‰å¼±å¼•ç”¨</strong>çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜</p>
</blockquote>
<h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">WeakMap</span>([iterable]);</span><br></pre></td></tr></table></figure>

<p><code>iterable</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆäºŒå…ƒæ•°ç»„ï¼‰æˆ–è€…å…¶ä»–å¯è¿­ä»£çš„ä¸”å…¶å…ƒç´ æ˜¯é”®å€¼å¯¹çš„å¯¹è±¡ã€‚æ¯ä¸ªé”®å€¼å¯¹ä¼šè¢«åŠ åˆ°æ–°çš„ WeakMap é‡Œã€‚null ä¼šè¢«å½“åš undefinedã€‚</p>
<p><strong>æ³¨ï¼šWeakMap çš„ key åªèƒ½æ˜¯ <code>Object</code> ç±»å‹ã€‚ åŸå§‹æ•°æ®ç±»å‹æ˜¯ä¸èƒ½ä½œä¸º key çš„ï¼ˆæ¯”å¦‚ Stringï¼‰ã€‚</strong></p>
<h4 id="ä½¿ç”¨-WeakMap-çš„åŸå› "><a href="#ä½¿ç”¨-WeakMap-çš„åŸå› " class="headerlink" title="ä½¿ç”¨ WeakMap çš„åŸå› "></a>ä½¿ç”¨ WeakMap çš„åŸå› </h4><p>åœ¨ JavaScript é‡Œï¼Œmap API å¯ä»¥é€šè¿‡ä½¿å…¶å››ä¸ª API æ–¹æ³•å…±ç”¨ä¸¤ä¸ªæ•°ç»„(ä¸€ä¸ªå­˜æ”¾é”®,ä¸€ä¸ªå­˜æ”¾å€¼)æ¥å®ç°ã€‚ç»™è¿™ç§ map è®¾ç½®å€¼æ—¶ä¼šåŒæ—¶å°†é”®å’Œå€¼æ·»åŠ åˆ°è¿™ä¸¤ä¸ªæ•°ç»„çš„æœ«å°¾ã€‚ä»è€Œä½¿å¾—é”®å’Œå€¼çš„ç´¢å¼•åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­ç›¸å¯¹åº”ã€‚å½“ä»è¯¥ map å–å€¼çš„æ—¶å€™ï¼Œéœ€è¦éå†æ‰€æœ‰çš„é”®ï¼Œç„¶åä½¿ç”¨ç´¢å¼•ä»å­˜å‚¨å€¼çš„æ•°ç»„ä¸­æ£€ç´¢å‡ºç›¸åº”çš„å€¼ã€‚</p>
<p>ä½†è¿™æ ·çš„å®ç°ä¼šæœ‰ä¸¤ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼Œé¦–å…ˆèµ‹å€¼å’Œæœç´¢æ“ä½œéƒ½æ˜¯ O(n) çš„æ—¶é—´å¤æ‚åº¦( n æ˜¯é”®å€¼å¯¹çš„ä¸ªæ•°)ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªæ“ä½œéƒ½éœ€è¦éå†å…¨éƒ¨æ•´ä¸ªæ•°ç»„æ¥è¿›è¡ŒåŒ¹é…ã€‚å¦å¤–ä¸€ä¸ªç¼ºç‚¹æ˜¯å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œå› ä¸ºæ•°ç»„ä¼šä¸€ç›´å¼•ç”¨ç€æ¯ä¸ªé”®å’Œå€¼ã€‚è¿™ç§å¼•ç”¨ä½¿å¾—åƒåœ¾å›æ”¶ç®—æ³•ä¸èƒ½å›æ”¶å¤„ç†ä»–ä»¬ï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–ä»»ä½•å¼•ç”¨å­˜åœ¨äº†ã€‚</p>
<p>åŸç”Ÿçš„ WeakMap æŒæœ‰çš„æ˜¯æ¯ä¸ªé”®å¯¹è±¡çš„â€œå¼±å¼•ç”¨â€ï¼Œè¿™æ„å‘³ç€åœ¨æ²¡æœ‰å…¶ä»–å¼•ç”¨å­˜åœ¨æ—¶åƒåœ¾å›æ”¶èƒ½æ­£ç¡®è¿›è¡Œã€‚åŸç”Ÿ WeakMap çš„ç»“æ„æ˜¯ç‰¹æ®Šä¸”æœ‰æ•ˆçš„ï¼Œå…¶ç”¨äºæ˜ å°„çš„ key åªæœ‰åœ¨å…¶æ²¡æœ‰è¢«å›æ”¶æ—¶æ‰æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<p>ç”±äºè¿™æ ·çš„å¼±å¼•ç”¨ï¼Œ<code>WeakMap</code> çš„ key æ˜¯<strong>ä¸å¯æšä¸¾</strong>çš„ (æ²¡æœ‰æ–¹æ³•èƒ½ç»™å‡ºæ‰€æœ‰çš„ key)ã€‚å¦‚æœ key æ˜¯å¯æšä¸¾çš„è¯ï¼Œå…¶åˆ—è¡¨å°†ä¼šå—åƒåœ¾å›æ”¶æœºåˆ¶çš„å½±å“ï¼Œä»è€Œå¾—åˆ°ä¸ç¡®å®šçš„ç»“æœã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦è¿™ç§ç±»å‹å¯¹è±¡çš„ key å€¼çš„åˆ—è¡¨ï¼Œä½ åº”è¯¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map"><code>Map</code></a>ã€‚</p>
<p>å¦‚æœä½ è¦<strong>å¾€å¯¹è±¡ä¸Šæ·»åŠ æ•°æ®ï¼Œåˆä¸æƒ³å¹²æ‰°åƒåœ¾å›æ”¶æœºåˆ¶</strong>ï¼Œå°±å¯ä»¥ä½¿ç”¨ WeakMapã€‚</p>
<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><ul>
<li><code>WeakMap.length</code>ï¼š0</li>
<li><code>WeakMap.prototype</code>ï¼šWeakMap æ„é€ å™¨çš„åŸå‹ï¼Œå…è®¸æ·»åŠ å±æ€§åˆ°æ‰€æœ‰çš„ WeakMap å¯¹è±¡ã€‚</li>
</ul>
<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line">wm.set(<span class="built_in">window</span>, <span class="string">&quot;foo&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="WeakMap-prototype-delete-key"><a href="#WeakMap-prototype-delete-key" class="headerlink" title="WeakMap.prototype.delete(key)"></a>WeakMap.prototype.delete(key)</h4><p>ä»ä¸€ä¸ª <code>WeakMap</code> å¯¹è±¡ä¸­åˆ é™¤æŒ‡å®šçš„å…ƒç´ ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wm.delete(<span class="built_in">window</span>); <span class="comment">// è¿”å› trueï¼Œè¡¨ç¤ºåˆ é™¤æˆåŠŸã€‚</span></span><br><span class="line">wm.has(<span class="built_in">window</span>); <span class="comment">// è¿”å› falseï¼Œå› ä¸º window å¯¹è±¡å·²ç»è¢«åˆ é™¤äº†ã€‚</span></span><br></pre></td></tr></table></figure>

<h4 id="WeakMap-prototype-get-key"><a href="#WeakMap-prototype-get-key" class="headerlink" title="WeakMap.prototype.get(key)"></a>WeakMap.prototype.get(key)</h4><p>è¿”å› Â <code>WeakMap</code> æŒ‡å®šçš„å…ƒç´ ï¼Œè¿”å›ä¸æŒ‡å®šé”®ç›¸å…³è”çš„å€¼ï¼Œå¦‚æœ <code>WeakMap</code> å¯¹è±¡æ‰¾ä¸åˆ°è¿™ä¸ªé”®åˆ™è¿”å› <code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wm.get(<span class="built_in">window</span>); <span class="comment">// è¿”å› &quot;foo&quot;.</span></span><br><span class="line">wm.get(<span class="string">&quot;baz&quot;</span>); <span class="comment">// è¿”å› undefined.</span></span><br></pre></td></tr></table></figure>

<h4 id="WeakMap-prototype-has-key"><a href="#WeakMap-prototype-has-key" class="headerlink" title="WeakMap.prototype.has(key)"></a>WeakMap.prototype.has(key)</h4><p>æ ¹æ® WeakMap å¯¹è±¡çš„å…ƒç´ ä¸­æ˜¯å¦å­˜åœ¨ key é”®è¿”å›ä¸€ä¸ª boolean å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wm.has(<span class="built_in">window</span>); <span class="comment">// returns true</span></span><br><span class="line">wm.has(<span class="string">&quot;baz&quot;</span>); <span class="comment">// returns false</span></span><br></pre></td></tr></table></figure>

<h4 id="WeakMap-prototype-set-key-value"><a href="#WeakMap-prototype-set-key-value" class="headerlink" title="WeakMap.prototype.set(key, value)"></a>WeakMap.prototype.set(key, value)</h4><p>æ ¹æ®æŒ‡å®šçš„<code>key</code>å’Œ<code>valueåœ¨</code> <code>WeakMap</code>å¯¹è±¡ä¸­æ·»åŠ æ–°/æ›´æ–°å…ƒç´ ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;</span><br><span class="line"><span class="comment">// Add new elements to the WeakMap</span></span><br><span class="line">wm.set(obj, <span class="string">&quot;foo&quot;</span>).set(<span class="built_in">window</span>, <span class="string">&quot;bar&quot;</span>); <span class="comment">// chainable</span></span><br><span class="line"><span class="comment">// Update an element in the WeakMap</span></span><br><span class="line">wm.set(obj, <span class="string">&quot;baz&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h2><blockquote>
<p>WeakSet å…è®¸å°†<em>å¼±ä¿æŒå¯¹è±¡</em>å­˜å‚¨åœ¨ä¸€ä¸ªé›†åˆä¸­ã€‚</p>
</blockquote>
<h3 id="ç”¨æ³•-1"><a href="#ç”¨æ³•-1" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">WeakSet</span>([iterable]);</span><br></pre></td></tr></table></figure>

<p>iterableï¼šä¼ å…¥ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/for...of">å¯è¿­ä»£å¯¹è±¡</a>ä½œä¸ºå‚æ•°, åˆ™è¯¥å¯¹è±¡çš„æ‰€æœ‰è¿­ä»£å€¼éƒ½ä¼šè¢«è‡ªåŠ¨æ·»åŠ è¿›ç”Ÿæˆçš„ <code>WeakSet</code> å¯¹è±¡ä¸­ã€‚null è¢«è®¤ä¸ºæ˜¯ undefinedã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"><span class="keyword">var</span> foo = &#123;&#125;;</span><br><span class="line"><span class="keyword">var</span> bar = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">ws.add(foo);</span><br><span class="line">ws.add(bar);</span><br><span class="line"></span><br><span class="line">ws.has(foo); <span class="comment">// true</span></span><br><span class="line">ws.has(bar); <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">ws.delete(foo); <span class="comment">// ä»setä¸­åˆ é™¤ foo å¯¹è±¡</span></span><br><span class="line">ws.has(foo); <span class="comment">// false, foo å¯¹è±¡å·²ç»è¢«åˆ é™¤äº†</span></span><br><span class="line">ws.has(bar); <span class="comment">// true, bar ä¾ç„¶å­˜åœ¨</span></span><br></pre></td></tr></table></figure>

<p><code>WeakSet</code> å¯¹è±¡æ˜¯ä¸€äº›å¯¹è±¡å€¼çš„é›†åˆ, å¹¶ä¸”å…¶ä¸­çš„æ¯ä¸ªå¯¹è±¡å€¼éƒ½åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œåœ¨<code>WeakSet</code>çš„é›†åˆä¸­æ˜¯<strong>å”¯ä¸€çš„</strong>ã€‚</p>
<h4 id="å’Œ-Set-å¯¹è±¡çš„åŒºåˆ«"><a href="#å’Œ-Set-å¯¹è±¡çš„åŒºåˆ«" class="headerlink" title="å’Œ Set å¯¹è±¡çš„åŒºåˆ«:"></a>å’Œ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Set"><code>Set</code></a> å¯¹è±¡çš„åŒºåˆ«:</h4><ul>
<li>ä¸<code>Set</code>ç›¸æ¯”ï¼Œ<code>WeakSet</code> åªèƒ½æ˜¯<strong>å¯¹è±¡çš„é›†åˆ</strong>ï¼Œè€Œä¸èƒ½æ˜¯ä»»ä½•ç±»å‹çš„ä»»æ„å€¼ã€‚</li>
<li><code>WeakSet</code>æŒå¼±å¼•ç”¨ï¼šé›†åˆä¸­å¯¹è±¡çš„å¼•ç”¨ä¸ºå¼±å¼•ç”¨ã€‚ å¦‚æœæ²¡æœ‰å…¶ä»–çš„å¯¹<code>WeakSet</code>ä¸­å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡ä¼šè¢«å½“æˆåƒåœ¾å›æ”¶æ‰ã€‚ è¿™ä¹Ÿæ„å‘³ç€ WeakSet ä¸­æ²¡æœ‰å­˜å‚¨å½“å‰å¯¹è±¡çš„åˆ—è¡¨ã€‚ æ­£å› ä¸ºè¿™æ ·ï¼Œ<code>WeakSet</code> æ˜¯ä¸å¯æšä¸¾çš„ã€‚</li>
</ul>
<p>WeakSet éå¸¸é€‚åˆå¤„ç†è¿™ç§æƒ…å†µï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹ ä¼ å…¥çš„subjectå¯¹è±¡ å†…éƒ¨å­˜å‚¨çš„æ‰€æœ‰å†…å®¹æ‰§è¡Œå›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execRecursively</span>(<span class="params">fn, subject, _refs = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!_refs) _refs = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é¿å…æ— é™é€’å½’</span></span><br><span class="line">  <span class="keyword">if</span> (_refs.has(subject)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  fn(subject);</span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;object&quot;</span> === <span class="keyword">typeof</span> subject) &#123;</span><br><span class="line">    _refs.add(subject);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> subject) execRecursively(fn, subject[key], _refs);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = &#123;</span><br><span class="line">  foo: <span class="string">&quot;Foo&quot;</span>,</span><br><span class="line">  bar: &#123;</span><br><span class="line">    bar: <span class="string">&quot;Bar&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">foo.bar.baz = foo; <span class="comment">// å¾ªç¯å¼•ç”¨!</span></span><br><span class="line">execRecursively(<span class="function">(<span class="params">obj</span>) =&gt;</span> <span class="built_in">console</span>.log(obj), foo);</span><br></pre></td></tr></table></figure>

<h3 id="æ–¹æ³•-1"><a href="#æ–¹æ³•-1" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><h4 id="WeakSet-prototype-add-value"><a href="#WeakSet-prototype-add-value" class="headerlink" title="WeakSet.prototype.add(value)"></a>WeakSet.prototype.add(value)</h4><h4 id="WeakSet-prototype-delete-value"><a href="#WeakSet-prototype-delete-value" class="headerlink" title="WeakSet.prototype.delete(value)"></a>WeakSet.prototype.delete(value)</h4><h4 id="WeakSet-prototype-has-value"><a href="#WeakSet-prototype-has-value" class="headerlink" title="WeakSet.prototype.has(value)"></a>WeakSet.prototype.has(value)</h4>
        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>httishere</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://httishere.github.io/2021/05/26/yuque/%E3%80%8Cjs%E3%80%8DWeakMap%20&%20WeakSet/">https://httishere.github.io/2021/05/26/yuque/%E3%80%8Cjs%E3%80%8DWeakMap%20&%20WeakSet/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2021 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Good Good Study, Day Day Up.</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2021/06/25/jp-article_02/">ã€Œæ—¥æœ¬èªã€ å’æ¥­æ–‡ç« ï¼ˆN5ï¼‰</a>
            
            
            <a class="next" rel="next" href="/2021/05/25/yuque/%E3%80%8Cjs%E3%80%8DProxy%20&%20Reflect/">ã€Œjsã€Proxy &amp; Reflect</a>
            
        </section>
        
            <link rel="stylesheet" href="https://unpkg.com/gitalk@latest/dist/gitalk.css">
<div id="gitalk-container" style="margin-top: 50px;"></div>
<script src="https://unpkg.com/gitalk@latest/dist/gitalk.min.js"></script>
<script src="https://priesttomb.github.io/js/md5.min.js"></script>
<script type="text/javascript">
    new Gitalk({
        clientID: '',
        clientSecret: '',
        id: window.location.pathname,
        repo: 'httIsHere.github.io',
        owner: 'httishere',
        admin: 'httishere',
        id: md5(location.pathname),
        distractionFreeMode: true
    }).render('gitalk-container')
</script>
        

    </article>
</div>

        </div>
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© httishere | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>
</html>
